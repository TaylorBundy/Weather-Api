<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Obtén pronósticos meteorológicos precisos para ciudades de Argentina. Selecciona tu provincia y ciudad para acceder a información detallada sobre temperatura, viento, precipitación y más, con previsiones para los próximos días.">
        <link rel="shortcut icon" href="Imagenes/favicon.ico">
        <link rel="stylesheet" href="styles.css">
        <title>Pronóstico del clima de Argentina</title>
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script> -->
        <!-- <script type="text/javascript" src="jquery.js"></script> -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script type="text/javascript" src="script.js" defer></script>
    </head>
    <body>
        <header>
            <h1>Seleccione una Provincia y Ciudad de Argentina</h1>
        </header>
        <main id="MainForm">
            <div class="RadioClass">
                <div class="api">
                    <label class="apiRadio" for="ApiWeb">
                        <input type="radio" aria-label="ApiWeb" id="ApiWeb" class="radio" name="radio" checked="checked" onclick="obtener()">Web
                    </label>
                </div>
                <div class="api">
                    <label class="apiRadio" for="ApiLocal">
                        <input type="radio" aria-label="ApiLocal" id="ApiLocal" class="radio" name="radio" onclick="obtener()">Clima Local
                    </label>
                </div>
            </div>
            <form action="#" method="POST">
                <label for="provincia">Provincias:</label>
                <select id="provincia" onmouseover="Titulos()">
                    <option selected="true" value="">Seleccionar una Provincia</option>
                    <option value="06">Buenos Aires</option>
                    <option value="10">Catamarca</option>
                    <option value="14">Córdoba</option>
                    <option value="18">Corrientes</option>
                    <option value="22">Chaco</option>
                    <option value="26">Chubut</option>
                    <option value="30">Entre Ríos</option>
                    <option value="34">Formosa</option>
                    <option value="38">Jujuy</option>
                    <option value="42">La Pampa</option>
                    <option value="46">La Rioja</option>
                    <option value="50">Mendoza</option>
                    <option value="54">Misiones</option>
                    <option value="58">Neuquén</option>
                    <option value="62">Río Negro</option>
                    <option value="66">Salta</option>
                    <option value="70">San Juan</option>
                    <option value="74">San Luis</option>
                    <option value="19">Santa Cruz</option>
                    <option value="82">Santa Fe</option>
                    <option value="21">Santiago del Estero</option>
                    <option value="94">Tierra del Fuego, Antártida e Islas del Atlántico Sur</option>
                    <option value="90">Tucumán</option>
                    <option value="02">Ciudad Autónoma de Buenos Aires</option>
                </select>
                <label for="ciudades">Ciudades:</label>
                <select name="ciudades" id="ciudades" onmouseover="Titulos()" disabled>
                    <option value="">Seleccione una ciudad</option>
                </select>
            </form>
            <input id="xlocalidad" style="visibility: collapse; display: none;">
            <div class="weather-card" id="weather-card">
                <h2 id="ciudad">Esperando Ciudad!</h2>
                <div class="current-weather">
                    <img src="Imagenes/sun-loading.svg" alt="Sun Loading" id="icon">
                    <p class="description" id="description">Descripción</p>
                </div>
                <div class="details">
                    <p id="wind">Viento: </p>
                    <p id="windDir">Direcc Viento: </p>
                    <p id="precip">Precipitación: </p>
                    <p id="pressure">Presión: </p>
                    <p id="humidity">Humedad: </p>
                    <p class="temp" id="temp">Temp</p>
                </div>
                <div class="forecast" id="AllForecast">
                    <div class="day">
                        <p id="Dia1" class="DayForecast">Día</p>
                        <img src="Imagenes/sun-loading.svg" alt="Cloudy" id="Icon-D1" class="IconForecast">
                        <p class="temp" id="Temp-D1">Temp</p>
                    </div>
                    <div class="day">
                        <p id="Dia2" class="DayForecast">Día</p>
                        <img src="Imagenes/sun-loading.svg" alt="Sunny" id="Icon-D2" class="IconForecast">
                        <p class="temp" id="Temp-D2">Temp</p>
                    </div>
                    <div class="day">
                        <p id="Dia3" class="DayForecast">Día</p>
                        <img src="Imagenes/sun-loading.svg" alt="Sunny" id="Icon-D3" class="IconForecast">
                        <p class="temp" id="Temp-D3">Temp</p>
                    </div>
                    <div class="day">
                        <p id="Dia4" class="DayForecast">Día</p>
                        <img src="Imagenes/sun-loading.svg" alt="Cloudy" id="Icon-D4" class="IconForecast">
                        <p class="temp" id="Temp-D4">Temp</p>
                    </div>
                    <div class="day">
                        <p id="Dia5" class="DayForecast">Día</p>
                        <img src="Imagenes/sun-loading.svg" alt="Cloudy" id="Icon-D5" class="IconForecast">
                        <p class="temp" id="Temp-D5">Temp</p>
                    </div>
                </div>
            </div>
            <div class="BotonClass">
                <div class="btn">
                    <button id="btnObtener" class="btn1" onclick="obtener()" onmouseover="Titulos()">
                        <span>Obtener</span>
                    </button>
                </div>
                <div class="btn">
                    <button id="btnActualizar" class="btn1" onclick="Actualiza()" onmouseover="Titulos()">
                        <span>Actualizar</span>
                    </button>
                </div>
            </div>
        </main>
        <footer>
            <p>&copy; 2024 Proyecto Web - Weather API - By Taylor Bundy</p>
            <div class="ImgSocial">
                <a href="https://www.facebook.com/marilyn6momsen" target="_blank"><img src="Imagenes/facebook.svg" alt="Facebook" id="facebook" onmouseover="Titulos()"> </a>
                <a href="https://www.instagram.com/taylor_bundy" target="_blank"><img src="Imagenes/instagram.webp" alt="Instagram" id="instagram" onmouseover="Titulos()"> </a>
                <a href="https://github.com/TaylorBundy" target="_blank"><img src="Imagenes/fluidicon.webp" alt="GitHub" id="github" onmouseover="Titulos()"> </a>
            </div>
        </footer>
        <script type="text/javascript">
            var respuesta;
            $.ajax({
                url: 'loc.json',
                type:  'get',
                beforeSend: function () {
                        //console.log("enviando");
                },
                success:  function (response) {
                    respuesta=response;
                }
            });

            const filtrar =(data, filtro, conte)=>{
                let $option, elemento, nombre, id_localidad, id_provincia, lolo, nuevoid, nuevomuni;
                try {
                    $("#ciudades").empty();
                }
                finally {
                    $(data).each((index)=>{
                        elemento= data[index];
                        id_provincia=elemento.id;
                        nuevomuni = data[index];
                        if (nuevomuni.nombre == conte) {
                            var municipios = nuevomuni["municipios"];
                            $(municipios).each((index)=>{
                                nombre = municipios[index]["nombre"];
                                nuevoid = municipios[index]["id"];
                                id_localidad = nuevoid;
                                if (filtro == id_provincia){
                                    $option += `<option data-l='${id_localidad}' data-p='${id_provincia}'> ${nombre} </option>`;
                                }
                            })
                        } else {
                        }
                        $("#localidades").html($option);
                        $("#ciudades").html($option);
                        document.querySelector("#ciudades").disabled = false;
                    })
                }
            }

            const cambiarLoc= ()=>{
                $("#ilocalidades").val("");
                let id_provincia = $("#provincia option:selected").val();
                const contenido = $("#provincia option:selected").text();
                let capitalizedText = contenido.charAt(0).toUpperCase() + contenido.slice(1);
                let contenido3 = contenido;
                $('#xlocalidad').val(contenido3);
                filtrar(respuesta, id_provincia, contenido);
            }

            const seleccionarLoc= ()=>{
                let loc = $("#localidades option:selected").data("l");
                $("#xlocalidad").val(loc);
            }

            $("#provincia").on("change", cambiarLoc);
            $("#localidades").change( ()=>{
                seleccionarLoc;
            });
            $("#ApiLocal").on("change", cambiarLoc);
            $("#ApiLocal").click( () => {
                document.querySelector("#provincia").selectedIndex = 14;
                document.querySelector("#ciudades").disabled = false;
            });
        </script>
    </body>
</html>